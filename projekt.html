<!DOCTYPE html>
<html>
<head>
    <title>Google Sheets Project Progress</title>
    <script src="https://apis.google.com/js/api.js"></script>
</head>
<body>
    <div id="content"></div>
    <script>
        // Google API Client Library betöltése és inicializálása
        function loadClient() {
            gapi.client.setApiKey('AIzaSyBDATDgITx1s8Rf8flyBcO8tGP6-BaEkLQ');
            return gapi.client.load('https://sheets.googleapis.com/$discovery/rest?version=v4')
                .then(function() { 
                    console.log('GAPI client loaded for API'); 
                }, function(err) { 
                    console.error('Error loading GAPI client for API', err); 
                });
        }

        // Adatok lekérése a Google Sheets API-tól
        function execute() {
            return gapi.client.sheets.spreadsheets.values.get({
                spreadsheetId: '1UxTVBvXT8Mo9grVpaz0udW3xYaaafkynmUS3notUhwg',
                range: 'SheetOne!A1',
            }).then(function(response) {
                var contentDiv = document.getElementById('content');
                var range = response.result.values;
                if (range.length > 0) {
                    contentDiv.innerHTML = 'Project Progress: ' + range[0][0];
                } else {
                    contentDiv.innerHTML = 'No data found.';
                }
            }, function(err) { 
                console.error('Execute error', err); 
            });
        }

        gapi.load('client', loadClient);

        // Az oldal betöltése után hajtsuk végre a lekérést
        window.onload = function() {
            loadClient().then(execute);
        };
    </script>
</body>
</html>